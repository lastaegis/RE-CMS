{"version":3,"sources":["../../../../../../../../../../resources/assets/plugins/backend/select2-4.0.3/src/js/select2/dropdown/infiniteScroll.js"],"names":["define","$","InfiniteScroll","decorated","$element","options","dataAdapter","lastParams","call","$loadingMore","createLoadingMore","loading","prototype","append","data","remove","showLoadingMore","$results","bind","container","$container","self","on","params","isLoadMoreVisible","contains","document","documentElement","currentOffset","offset","top","outerHeight","loadingMoreOffset","loadMore","extend","page","trigger","_","pagination","more","$option","message","get","html"],"mappings":"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","file":"infiniteScroll.js","sourcesContent":["define([\n  'jquery'\n], function ($) {\n  function InfiniteScroll (decorated, $element, options, dataAdapter) {\n    this.lastParams = {};\n\n    decorated.call(this, $element, options, dataAdapter);\n\n    this.$loadingMore = this.createLoadingMore();\n    this.loading = false;\n  }\n\n  InfiniteScroll.prototype.append = function (decorated, data) {\n    this.$loadingMore.remove();\n    this.loading = false;\n\n    decorated.call(this, data);\n\n    if (this.showLoadingMore(data)) {\n      this.$results.append(this.$loadingMore);\n    }\n  };\n\n  InfiniteScroll.prototype.bind = function (decorated, container, $container) {\n    var self = this;\n\n    decorated.call(this, container, $container);\n\n    container.on('query', function (params) {\n      self.lastParams = params;\n      self.loading = true;\n    });\n\n    container.on('query:append', function (params) {\n      self.lastParams = params;\n      self.loading = true;\n    });\n\n    this.$results.on('scroll', function () {\n      var isLoadMoreVisible = $.contains(\n        document.documentElement,\n        self.$loadingMore[0]\n      );\n\n      if (self.loading || !isLoadMoreVisible) {\n        return;\n      }\n\n      var currentOffset = self.$results.offset().top +\n        self.$results.outerHeight(false);\n      var loadingMoreOffset = self.$loadingMore.offset().top +\n        self.$loadingMore.outerHeight(false);\n\n      if (currentOffset + 50 >= loadingMoreOffset) {\n        self.loadMore();\n      }\n    });\n  };\n\n  InfiniteScroll.prototype.loadMore = function () {\n    this.loading = true;\n\n    var params = $.extend({}, {page: 1}, this.lastParams);\n\n    params.page++;\n\n    this.trigger('query:append', params);\n  };\n\n  InfiniteScroll.prototype.showLoadingMore = function (_, data) {\n    return data.pagination && data.pagination.more;\n  };\n\n  InfiniteScroll.prototype.createLoadingMore = function () {\n    var $option = $(\n      '<li ' +\n      'class=\"select2-results__option select2-results__option--load-more\"' +\n      'role=\"treeitem\" aria-disabled=\"true\"></li>'\n    );\n\n    var message = this.options.get('translations').get('loadingMore');\n\n    $option.html(message(this.lastParams));\n\n    return $option;\n  };\n\n  return InfiniteScroll;\n});\n"]}