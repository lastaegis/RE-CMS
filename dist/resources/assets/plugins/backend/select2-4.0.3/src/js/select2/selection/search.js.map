{"version":3,"sources":["../../../../../../../../../../resources/assets/plugins/backend/select2-4.0.3/src/js/select2/selection/search.js"],"names":["define","$","Utils","KEYS","Search","decorated","$element","options","call","prototype","render","$search","$searchContainer","find","$rendered","_transferTabIndex","bind","container","$container","self","on","trigger","val","removeAttr","prop","evt","params","attr","id","$selection","_handleBlur","stopPropagation","_keyUpPrevented","isDefaultPrevented","key","which","BACKSPACE","$previousChoice","prev","length","item","data","searchRemoveChoice","preventDefault","msie","document","documentMode","disableInputEvents","off","type","SHIFT","CTRL","ALT","TAB","handleSearch","createPlaceholder","placeholder","text","update","searchHadFocus","activeElement","append","resizeSearch","focus","input","term","css","width","innerWidth","minimumWidth"],"mappings":"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","file":"search.js","sourcesContent":["define([\n  'jquery',\n  '../utils',\n  '../keys'\n], function ($, Utils, KEYS) {\n  function Search (decorated, $element, options) {\n    decorated.call(this, $element, options);\n  }\n\n  Search.prototype.render = function (decorated) {\n    var $search = $(\n      '<li class=\"select2-search select2-search--inline\">' +\n        '<input class=\"select2-search__field\" type=\"search\" tabindex=\"-1\"' +\n        ' autocomplete=\"off\" autocorrect=\"off\" autocapitalize=\"off\"' +\n        ' spellcheck=\"false\" role=\"textbox\" aria-autocomplete=\"list\" />' +\n      '</li>'\n    );\n\n    this.$searchContainer = $search;\n    this.$search = $search.find('input');\n\n    var $rendered = decorated.call(this);\n\n    this._transferTabIndex();\n\n    return $rendered;\n  };\n\n  Search.prototype.bind = function (decorated, container, $container) {\n    var self = this;\n\n    decorated.call(this, container, $container);\n\n    container.on('open', function () {\n      self.$search.trigger('focus');\n    });\n\n    container.on('close', function () {\n      self.$search.val('');\n      self.$search.removeAttr('aria-activedescendant');\n      self.$search.trigger('focus');\n    });\n\n    container.on('enable', function () {\n      self.$search.prop('disabled', false);\n\n      self._transferTabIndex();\n    });\n\n    container.on('disable', function () {\n      self.$search.prop('disabled', true);\n    });\n\n    container.on('focus', function (evt) {\n      self.$search.trigger('focus');\n    });\n\n    container.on('results:focus', function (params) {\n      self.$search.attr('aria-activedescendant', params.id);\n    });\n\n    this.$selection.on('focusin', '.select2-search--inline', function (evt) {\n      self.trigger('focus', evt);\n    });\n\n    this.$selection.on('focusout', '.select2-search--inline', function (evt) {\n      self._handleBlur(evt);\n    });\n\n    this.$selection.on('keydown', '.select2-search--inline', function (evt) {\n      evt.stopPropagation();\n\n      self.trigger('keypress', evt);\n\n      self._keyUpPrevented = evt.isDefaultPrevented();\n\n      var key = evt.which;\n\n      if (key === KEYS.BACKSPACE && self.$search.val() === '') {\n        var $previousChoice = self.$searchContainer\n          .prev('.select2-selection__choice');\n\n        if ($previousChoice.length > 0) {\n          var item = $previousChoice.data('data');\n\n          self.searchRemoveChoice(item);\n\n          evt.preventDefault();\n        }\n      }\n    });\n\n    // Try to detect the IE version should the `documentMode` property that\n    // is stored on the document. This is only implemented in IE and is\n    // slightly cleaner than doing a user agent check.\n    // This property is not available in Edge, but Edge also doesn't have\n    // this bug.\n    var msie = document.documentMode;\n    var disableInputEvents = msie && msie <= 11;\n\n    // Workaround for browsers which do not support the `input` event\n    // This will prevent double-triggering of events for browsers which support\n    // both the `keyup` and `input` events.\n    this.$selection.on(\n      'input.searchcheck',\n      '.select2-search--inline',\n      function (evt) {\n        // IE will trigger the `input` event when a placeholder is used on a\n        // search box. To get around this issue, we are forced to ignore all\n        // `input` events in IE and keep using `keyup`.\n        if (disableInputEvents) {\n          self.$selection.off('input.search input.searchcheck');\n          return;\n        }\n\n        // Unbind the duplicated `keyup` event\n        self.$selection.off('keyup.search');\n      }\n    );\n\n    this.$selection.on(\n      'keyup.search input.search',\n      '.select2-search--inline',\n      function (evt) {\n        // IE will trigger the `input` event when a placeholder is used on a\n        // search box. To get around this issue, we are forced to ignore all\n        // `input` events in IE and keep using `keyup`.\n        if (disableInputEvents && evt.type === 'input') {\n          self.$selection.off('input.search input.searchcheck');\n          return;\n        }\n\n        var key = evt.which;\n\n        // We can freely ignore events from modifier keys\n        if (key == KEYS.SHIFT || key == KEYS.CTRL || key == KEYS.ALT) {\n          return;\n        }\n\n        // Tabbing will be handled during the `keydown` phase\n        if (key == KEYS.TAB) {\n          return;\n        }\n\n        self.handleSearch(evt);\n      }\n    );\n  };\n\n  /**\n   * This method will transfer the tabindex attribute from the rendered\n   * selection to the search box. This allows for the search box to be used as\n   * the primary focus instead of the selection container.\n   *\n   * @private\n   */\n  Search.prototype._transferTabIndex = function (decorated) {\n    this.$search.attr('tabindex', this.$selection.attr('tabindex'));\n    this.$selection.attr('tabindex', '-1');\n  };\n\n  Search.prototype.createPlaceholder = function (decorated, placeholder) {\n    this.$search.attr('placeholder', placeholder.text);\n  };\n\n  Search.prototype.update = function (decorated, data) {\n    var searchHadFocus = this.$search[0] == document.activeElement;\n\n    this.$search.attr('placeholder', '');\n\n    decorated.call(this, data);\n\n    this.$selection.find('.select2-selection__rendered')\n                   .append(this.$searchContainer);\n\n    this.resizeSearch();\n    if (searchHadFocus) {\n      this.$search.focus();\n    }\n  };\n\n  Search.prototype.handleSearch = function () {\n    this.resizeSearch();\n\n    if (!this._keyUpPrevented) {\n      var input = this.$search.val();\n\n      this.trigger('query', {\n        term: input\n      });\n    }\n\n    this._keyUpPrevented = false;\n  };\n\n  Search.prototype.searchRemoveChoice = function (decorated, item) {\n    this.trigger('unselect', {\n      data: item\n    });\n\n    this.$search.val(item.text);\n    this.handleSearch();\n  };\n\n  Search.prototype.resizeSearch = function () {\n    this.$search.css('width', '25px');\n\n    var width = '';\n\n    if (this.$search.attr('placeholder') !== '') {\n      width = this.$selection.find('.select2-selection__rendered').innerWidth();\n    } else {\n      var minimumWidth = this.$search.val().length + 1;\n\n      width = (minimumWidth * 0.75) + 'em';\n    }\n\n    this.$search.css('width', width);\n  };\n\n  return Search;\n});\n"]}