{"version":3,"sources":["../../../../../../../../../../resources/assets/plugins/backend/select2-4.0.3/src/js/select2/dropdown/attachBody.js"],"names":["define","$","Utils","AttachBody","decorated","$element","options","$dropdownParent","get","document","body","call","prototype","bind","container","$container","self","setupResultsEvents","on","_showDropdown","_attachPositioningHandler","_positionDropdown","_resizeDropdown","_hideDropdown","_detachPositioningHandler","$dropdownContainer","evt","stopPropagation","destroy","remove","position","$dropdown","attr","removeClass","addClass","css","top","render","append","detach","scrollEvent","id","resizeEvent","orientationEvent","$watchers","parents","filter","hasScroll","each","data","x","scrollLeft","y","scrollTop","ev","window","e","off","$window","isCurrentlyAbove","hasClass","isCurrentlyBelow","newDirection","offset","bottom","outerHeight","height","dropdown","viewport","enoughRoomAbove","enoughRoomBelow","left","$offsetParent","offsetParent","parentOffset","width","outerWidth","minWidth","appendTo"],"mappings":"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","file":"attachBody.js","sourcesContent":["define([\n  'jquery',\n  '../utils'\n], function ($, Utils) {\n  function AttachBody (decorated, $element, options) {\n    this.$dropdownParent = options.get('dropdownParent') || $(document.body);\n\n    decorated.call(this, $element, options);\n  }\n\n  AttachBody.prototype.bind = function (decorated, container, $container) {\n    var self = this;\n\n    var setupResultsEvents = false;\n\n    decorated.call(this, container, $container);\n\n    container.on('open', function () {\n      self._showDropdown();\n      self._attachPositioningHandler(container);\n\n      if (!setupResultsEvents) {\n        setupResultsEvents = true;\n\n        container.on('results:all', function () {\n          self._positionDropdown();\n          self._resizeDropdown();\n        });\n\n        container.on('results:append', function () {\n          self._positionDropdown();\n          self._resizeDropdown();\n        });\n      }\n    });\n\n    container.on('close', function () {\n      self._hideDropdown();\n      self._detachPositioningHandler(container);\n    });\n\n    this.$dropdownContainer.on('mousedown', function (evt) {\n      evt.stopPropagation();\n    });\n  };\n\n  AttachBody.prototype.destroy = function (decorated) {\n    decorated.call(this);\n\n    this.$dropdownContainer.remove();\n  };\n\n  AttachBody.prototype.position = function (decorated, $dropdown, $container) {\n    // Clone all of the container classes\n    $dropdown.attr('class', $container.attr('class'));\n\n    $dropdown.removeClass('select2');\n    $dropdown.addClass('select2-container--open');\n\n    $dropdown.css({\n      position: 'absolute',\n      top: -999999\n    });\n\n    this.$container = $container;\n  };\n\n  AttachBody.prototype.render = function (decorated) {\n    var $container = $('<span></span>');\n\n    var $dropdown = decorated.call(this);\n    $container.append($dropdown);\n\n    this.$dropdownContainer = $container;\n\n    return $container;\n  };\n\n  AttachBody.prototype._hideDropdown = function (decorated) {\n    this.$dropdownContainer.detach();\n  };\n\n  AttachBody.prototype._attachPositioningHandler =\n      function (decorated, container) {\n    var self = this;\n\n    var scrollEvent = 'scroll.select2.' + container.id;\n    var resizeEvent = 'resize.select2.' + container.id;\n    var orientationEvent = 'orientationchange.select2.' + container.id;\n\n    var $watchers = this.$container.parents().filter(Utils.hasScroll);\n    $watchers.each(function () {\n      $(this).data('select2-scroll-position', {\n        x: $(this).scrollLeft(),\n        y: $(this).scrollTop()\n      });\n    });\n\n    $watchers.on(scrollEvent, function (ev) {\n      var position = $(this).data('select2-scroll-position');\n      $(this).scrollTop(position.y);\n    });\n\n    $(window).on(scrollEvent + ' ' + resizeEvent + ' ' + orientationEvent,\n      function (e) {\n      self._positionDropdown();\n      self._resizeDropdown();\n    });\n  };\n\n  AttachBody.prototype._detachPositioningHandler =\n      function (decorated, container) {\n    var scrollEvent = 'scroll.select2.' + container.id;\n    var resizeEvent = 'resize.select2.' + container.id;\n    var orientationEvent = 'orientationchange.select2.' + container.id;\n\n    var $watchers = this.$container.parents().filter(Utils.hasScroll);\n    $watchers.off(scrollEvent);\n\n    $(window).off(scrollEvent + ' ' + resizeEvent + ' ' + orientationEvent);\n  };\n\n  AttachBody.prototype._positionDropdown = function () {\n    var $window = $(window);\n\n    var isCurrentlyAbove = this.$dropdown.hasClass('select2-dropdown--above');\n    var isCurrentlyBelow = this.$dropdown.hasClass('select2-dropdown--below');\n\n    var newDirection = null;\n\n    var offset = this.$container.offset();\n\n    offset.bottom = offset.top + this.$container.outerHeight(false);\n\n    var container = {\n      height: this.$container.outerHeight(false)\n    };\n\n    container.top = offset.top;\n    container.bottom = offset.top + container.height;\n\n    var dropdown = {\n      height: this.$dropdown.outerHeight(false)\n    };\n\n    var viewport = {\n      top: $window.scrollTop(),\n      bottom: $window.scrollTop() + $window.height()\n    };\n\n    var enoughRoomAbove = viewport.top < (offset.top - dropdown.height);\n    var enoughRoomBelow = viewport.bottom > (offset.bottom + dropdown.height);\n\n    var css = {\n      left: offset.left,\n      top: container.bottom\n    };\n\n    // Determine what the parent element is to use for calciulating the offset\n    var $offsetParent = this.$dropdownParent;\n\n    // For statically positoned elements, we need to get the element\n    // that is determining the offset\n    if ($offsetParent.css('position') === 'static') {\n      $offsetParent = $offsetParent.offsetParent();\n    }\n\n    var parentOffset = $offsetParent.offset();\n\n    css.top -= parentOffset.top;\n    css.left -= parentOffset.left;\n\n    if (!isCurrentlyAbove && !isCurrentlyBelow) {\n      newDirection = 'below';\n    }\n\n    if (!enoughRoomBelow && enoughRoomAbove && !isCurrentlyAbove) {\n      newDirection = 'above';\n    } else if (!enoughRoomAbove && enoughRoomBelow && isCurrentlyAbove) {\n      newDirection = 'below';\n    }\n\n    if (newDirection == 'above' ||\n      (isCurrentlyAbove && newDirection !== 'below')) {\n      css.top = container.top - parentOffset.top - dropdown.height;\n    }\n\n    if (newDirection != null) {\n      this.$dropdown\n        .removeClass('select2-dropdown--below select2-dropdown--above')\n        .addClass('select2-dropdown--' + newDirection);\n      this.$container\n        .removeClass('select2-container--below select2-container--above')\n        .addClass('select2-container--' + newDirection);\n    }\n\n    this.$dropdownContainer.css(css);\n  };\n\n  AttachBody.prototype._resizeDropdown = function () {\n    var css = {\n      width: this.$container.outerWidth(false) + 'px'\n    };\n\n    if (this.options.get('dropdownAutoWidth')) {\n      css.minWidth = css.width;\n      css.position = 'relative';\n      css.width = 'auto';\n    }\n\n    this.$dropdown.css(css);\n  };\n\n  AttachBody.prototype._showDropdown = function (decorated) {\n    this.$dropdownContainer.appendTo(this.$dropdownParent);\n\n    this._positionDropdown();\n    this._resizeDropdown();\n  };\n\n  return AttachBody;\n});\n"]}